checkout:
    post:
      - export BASE_DIR=${GOPATH%%:*}/src/github.com/${CIRCLE_PROJECT_USERNAME}
      - export REPO_DIR=${BASE_DIR}/$(basename $(pwd))
      - export GO15VENDOREXPERIMENT=1
      - mkdir -p ${BASE_DIR}
      - ln -sf $(pwd) ${REPO_DIR}

dependencies:
  pre:
    - git submodule update --init --recursive:
        pwd: ${REPO_DIR}

test:
  pre:
    - make vet:
        pwd: ${REPO_DIR}

  override:
    - make test:
        pwd: ${REPO_DIR}
